your-project-name/
â”‚
â”œâ”€â”€ src/                      # Code chÃ­nh (core logic)
â”‚   â”œâ”€â”€ db/                   # CÃ¡c module liÃªn quan Ä‘áº¿n database
â”‚   â”‚   â”œâ”€â”€ mongo_utils.py    # HÃ m add/find object trong MongoDB
â”‚   â”‚   â””â”€â”€ faiss_utils.py    # HÃ m build, add, search FAISS index
â”‚   â”‚
â”‚   â”œâ”€â”€ models/               # Code load vÃ  cháº¡y model AI
â”‚   â”‚   â”œâ”€â”€ clip_encoder.py   # Sinh embedding báº±ng CLIP
â”‚   â”‚   â”œâ”€â”€ grounding_dino.py # Detect object báº±ng Grounding DINO
â”‚   â”‚   â””â”€â”€ sam_segment.py    # Segment object báº±ng SAM
â”‚   â”‚
â”‚   â”œâ”€â”€ pipeline/             # Logic pipeline
â”‚   â”‚   â”œâ”€â”€ add_image.py      # Flow: load áº£nh â†’ metadata â†’ embedding â†’ DB/FAISS
â”‚   â”‚   â”œâ”€â”€ search.py         # Flow: text â†’ embedding â†’ search FAISS â†’ láº¥y áº£nh
â”‚   â”‚   â””â”€â”€ segment.py        # Flow: search result â†’ segmentation object
â”‚   â”‚
â”‚   â””â”€â”€ config.py             # Config Mongo URI, model paths, constants
â”‚
â”œâ”€â”€ scripts/                  # Script CLI tiá»‡n Ã­ch
â”‚   â”œâ”€â”€ build_index.py        # Build FAISS index tá»« embeddings cÃ³ sáºµn
â”‚   â”œâ”€â”€ add_folder.py         # ThÃªm 1 folder áº£nh vÃ o DB + FAISS
â”‚   â””â”€â”€ search_prompt.py      # Demo: nháº­p prompt â†’ tráº£ káº¿t quáº£
â”‚
â”œâ”€â”€ notebooks/                # Jupyter notebooks demo
â”‚   â”œâ”€â”€ 01_generate_embeddings.ipynb
â”‚   â”œâ”€â”€ 02_search_demo.ipynb
â”‚   â””â”€â”€ 03_segmentation_demo.ipynb
â”‚
â”œâ”€â”€ api/                      # Náº¿u báº¡n lÃ m web service
â”‚   â””â”€â”€ main.py               # FastAPI app: upload/search/segment endpoints
â”‚
â”œâ”€â”€ frontend/ (optional)      # Náº¿u cÃ³ web UI demo
â”‚   â””â”€â”€ app.py                # Streamlit/Gradio app
â”‚
â”œâ”€â”€ tests/                    # Unit test cho cÃ¡c module
â”‚
â”œâ”€â”€ requirements.txt          # ThÆ° viá»‡n cáº§n thiáº¿t (faiss, pymongo, torch, ...)
â”œâ”€â”€ README.md                 # Giá»›i thiá»‡u project, hÆ°á»›ng dáº«n cháº¡y
â”œâ”€â”€ .gitignore                # Ignore data, faiss index, large files
â””â”€â”€ data/                     # Chá»‰ Ä‘á»ƒ vÃ i áº£nh demo nhá» (khÃ´ng push data lá»›n)
    â”œâ”€â”€ sample1.jpg
    â””â”€â”€ sample2.jpg


3. pipeline/segment.py

Nhiá»‡m vá»¥: tá»« áº£nh káº¿t quáº£ search, cháº¡y segmentation (SAM + Grounding DINO).

Class chÃ­nh: SegmentPipeline

CÃ¡c bÆ°á»›c logic:

Input: (image hoáº·c image_id tá»« DB).

Náº¿u cáº§n, cháº¡y Grounding DINO Ä‘á»ƒ detect bounding boxes.

Cháº¡y SAM Ä‘á»ƒ segment ra mask(s).

Tráº£ káº¿t quáº£: mask(s) + áº£nh overlay.

ğŸ‘‰ Trong file:

class SegmentPipeline: (constructor nháº­n sam_model, grounding_dino)

def segment(self, image, text_prompt=None): ...

CÃ³ thá»ƒ tÃ¡ch nhá»:

_detect_objects(image, text_prompt)

_segment_masks(image, boxes)
